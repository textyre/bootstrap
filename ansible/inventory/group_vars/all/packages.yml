---
# === ЦЕНТРАЛЬНЫЙ РЕЕСТР ПАКЕТОВ ===
# Единственный источник данных для ролей packages, yay.
# Роли содержат только логику; данные живут здесь.
#
# Сервисы (docker, lightdm) → соответствующие роли docker/lightdm
# Группы пользователя → роль user (system.yml)
#
# Переопределение:
#   Per-host:    inventory/host_vars/<hostname>/packages.yml
#   Per-runtime: ansible-playbook ... -e '{"packages_docker": ["docker", "docker-compose", "docker-buildx"]}'
#
# Ansible precedence: role defaults (2) < group_vars/all (4) < host_vars (8) < -e (22)

# ============================================================
#  yay (AUR helper) — роль roles/yay
# ============================================================

# URL репозитория yay в AUR
yay_aur_url: "https://aur.archlinux.org/yay.git"

# Пользователь для сборки (makepkg не работает от root)
yay_build_user: "{{ ansible_facts['env']['SUDO_USER'] | default(ansible_facts['user_id']) }}"

# Зависимости для сборки yay из исходников
yay_build_deps:
  - base-devel
  - git
  - go

# ============================================================
#  Пакеты рабочей станции — роль roles/packages
# ============================================================

# --- Базовые утилиты ---
packages_base:
  - git
  - curl
  - htop
  - tmux
  - unzip
  - rsync
  - openssh          # SSH клиент/сервер (для роли ssh)
  - chezmoi          # Менеджер дотфайлов (для роли chezmoi)
  - nftables         # Firewall (для роли firewall)
  - cronie           # Планировщик задач (cron, для бэкапов Vaultwarden)
  - sqlite           # SQLite CLI (для бэкапов Vaultwarden)

# --- Редакторы ---
packages_editors:
  - vim
  - neovim

# --- Docker ---
packages_docker:
  - docker
  - docker-compose
  - python-requests  # Python HTTP (для community.docker.* модулей Ansible)

# --- Xorg: сервер, утилиты, драйверы ---
packages_xorg:
  - xorg              # Xorg core (xorg-server, etc.)
  - xorg-apps         # утилиты X (xrandr, xrdb, xauth...)
  - xorg-xinit        # startx / xinit
  - xorg-drivers      # видеодрайверы Xorg

# --- Оконный менеджер: визуал и хелперы ---
# i3 ставится из AUR (i3-rounded-border-patch-git) — закруглённые углы
# picom ставится из pacman (официальный, v12+ с анимациями и rules)
packages_wm:
  - picom             # композитор (анимации, тени, размытие, rules)
  - dmenu             # минимальный лаунчер (фолбэк)
  # - polybar         # ОТКЛЮЧЕНО: заменено на eww (ewwii)
  - rofi              # лаунчер приложений и меню
  - dunst             # демон уведомлений
  - feh               # управление обоями
  - flameshot         # скриншоты
  - gsimplecal        # лёгкий GTK-календарь (popup при клике на часы)

# --- Файловый менеджер ---
packages_filemanager:
  - thunar            # GUI файловый менеджер
  - thunar-volman     # управление съёмными носителями
  - tumbler           # миниатюры
  - gvfs              # корзина / удалённые ФС

# --- Сеть ---
packages_network:
  - networkmanager
  - network-manager-applet

# --- Медиа и управление ---
packages_media:
  - playerctl         # MPRIS управление плеером
  - pamixer           # управление громкостью PulseAudio
  - brightnessctl     # управление яркостью

# --- Десктоп-интеграция ---
packages_desktop:
  - xdg-utils         # xdg-open и другие
  - xdg-user-dirs     # ~/Documents, ~/Downloads, ...
  - xss-lock          # автоблокировка экрана
  - maim              # быстрый захват экрана (lock screen)
  - imagemagick       # блюр для lock screen
  - lxappearance      # GTK тема (GUI)
  - arandr            # GUI для xrandr (настройки дисплея)

# --- Графика ---
packages_graphics:
  - mesa              # OpenGL/GLX (Intel/AMD)

# --- Сессия / грифтер ---
packages_session:
  - lightdm             # display manager
  # nody-greeter (AUR) — устанавливается через packages_aur

# --- Терминал ---
packages_terminal:
  - alacritty         # GPU-accelerated терминал
  - starship          # Cross-shell промпт с Nerd Font иконками

# --- Шрифты ---
packages_fonts:
  - ttf-jetbrains-mono-nerd  # JetBrains Mono + Nerd Font иконки
  - ttf-firacode-nerd
  - ttf-hack-nerd
  - ttf-iosevka-nerd
  - ttf-nerd-fonts-symbols   # только символы/иконки Nerd Font
  - ttf-font-awesome
  - noto-fonts
  - terminus-font            # bitmap шрифт

# --- Темы и иконки ---
packages_theming:
  - papirus-icon-theme       # иконки Papirus

# --- Поиск (fuzzy finder + grep замена) ---
packages_search:
  - fzf               # интерактивный fuzzy finder
  - ripgrep           # быстрый grep (rg)

# --- Просмотр файлов и данных ---
packages_viewers:
  - bat               # cat с подсветкой синтаксиса
  - jq                # просмотр и обработка JSON

# --- Пакеты специфичные для дистрибутива ---
# Ключи: Archlinux, Debian (значения ansible_os_family)
packages_distro:
  Archlinux:
    - base-devel       # компиляция, makepkg
    - pacman-contrib   # paccache, checkupdates, pacdiff
    - perl             # pod2man и др., нужен для сборки AUR пакетов (i3, etc.)
  Debian:
    - build-essential

# --- VirtualBox Guest Additions (only if running in VirtualBox VM) ---
# Used by role: vm
packages_virtualbox_guest:
  - virtualbox-guest-utils   # Guest Additions (shared folders, clipboard, vboxvideo)

# --- VMware Guest Tools (only if running in VMware VM) ---
# Used by role: vm
packages_vmware_guest:
  - open-vm-tools            # VMware guest tools (vmtoolsd, vgauthd)

# --- Hyper-V Guest Daemons (only if running in Hyper-V VM) ---
# Used by role: vm
packages_hyperv_guest:
  - hyperv                   # hv_fcopy, hv_kvp, hv_vss daemons

# --- QEMU/KVM Guest Agent (only if running in KVM/QEMU VM) ---
# Used by role: vm
packages_kvm_guest:
  - qemu-guest-agent         # Guest Agent (filesystem freeze, shutdown, exec)

# --- Пакеты конфликтующие с AUR заменами ---
# Удаляются перед установкой AUR пакетов
packages_aur_remove_conflicts:
  - i3lock            # заменяется на i3lock-color из AUR
  - i3-wm             # заменяется на i3-rounded-border-patch-git из AUR
  - lightdm-gtk-greeter # заменяется на nody-greeter из AUR

# --- AUR пакеты (только Arch Linux, через yay) ---
# yay устанавливается отдельной ролью (roles/yay)
packages_aur:
  - i3-rounded-border-patch-git   # i3 с патчем для скруглённых углов
  - i3lock-color                  # lock screen с кастомизацией цветов
  - rofi-greenclip                # менеджер буфера обмена для rofi
  - dracula-gtk-theme             # Dracula GTK тема
  - eww-git                       # виджет-фреймворк для статус-бара (ewwii)
  - nody-greeter                   # LightDM web-гритер (Electron) для ctOS темы
