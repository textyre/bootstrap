---
# === Hyper-V Guest Daemons ===

- name: "Hyper-V: Install guest packages"
  ansible.builtin.package:
    name: "{{ packages_hyperv_guest }}"
    state: present
  when: packages_hyperv_guest | length > 0
  tags: ['drivers', 'hyperv']

- name: "Hyper-V: Enable guest daemons"
  ansible.builtin.systemd:
    name: "{{ item }}"
    enabled: true
    state: started
  loop:
    - hv_fcopy_daemon
    - hv_kvp_daemon
    - hv_vss_daemon
  failed_when: false
  tags: ['drivers', 'hyperv']

- name: "Hyper-V: Report"
  ansible.builtin.debug:
    msg: "Hyper-V guest daemons installed and enabled"
  tags: ['drivers', 'hyperv']
