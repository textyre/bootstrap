---
# === Console keymap handlers ===

- name: Apply vconsole settings (systemd)
  ansible.builtin.systemd:
    name: systemd-vconsole-setup.service
    state: restarted
  listen: "apply keymap"
  when: ansible_facts['service_mgr'] == 'systemd'

- name: Apply keymap (openrc/runit)
  ansible.builtin.command: "loadkeys {{ _keymap_value }}"
  listen: "apply keymap"
  when: ansible_facts['service_mgr'] in ['openrc', 'runit']
  changed_when: false

- name: Apply font (openrc/runit)
  ansible.builtin.command: "setfont {{ keymap_console_font }}"
  listen: "apply keymap"
  when:
    - ansible_facts['service_mgr'] in ['openrc', 'runit']
    - keymap_console_font | default('') | length > 0
  changed_when: false
