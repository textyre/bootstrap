---
# === Validate keymap configuration ===

- name: Assert keymap_console is defined and non-empty
  ansible.builtin.assert:
    that:
      - keymap_console is defined
      - keymap_console | length > 0
    fail_msg: >-
      keymap_console must be set to a valid keymap name (e.g. 'us', 'ru').
      Current value: '{{ keymap_console | default("") }}'
  tags: ['keymap']

- name: Assert font is set when font_map or font_unimap are used
  ansible.builtin.assert:
    that:
      - keymap_console_font | default('') | length > 0
    fail_msg: >-
      keymap_console_font_map/font_unimap require keymap_console_font to be set.
      font_map: '{{ keymap_console_font_map | default("") }}'
      font_unimap: '{{ keymap_console_font_unimap | default("") }}'
      Current keymap_console_font: '{{ keymap_console_font | default("") }}'
  when: >-
    (keymap_console_font_map | default('') | length > 0) or
    (keymap_console_font_unimap | default('') | length > 0)
  tags: ['keymap']
