---
# =========================================================================
# report_render.yml — render execution report table
# =========================================================================
# Usage:
#   - ansible.builtin.include_role:
#       name: common
#       tasks_from: report_render.yml
#     vars:
#       commoncommon_rpt_fact: "_base_system_phases"
#       commoncommon_rpt_title: "base_system"
#       commoncommon_rpt_footer_rows: []   # optional extra footer rows
#
# Parameters:
#   _rpt_fact        (string) - Fact name with accumulated rows (REQUIRED)
#   _rpt_title       (string) - Role name for the report header (REQUIRED)
#   _rpt_footer_rows (list)   - Extra pre-formatted rows before closing line
# =========================================================================

- name: "{{ common_rpt_title }} — Execution Report"
  ansible.builtin.debug:
    msg: "{{ _header + (lookup('vars', _rpt_fact, default=[]) | list) + _extra + _footer }}"
  vars:
    _header:
      - "+----------------------------+------------+--------------------------+"
      - "| Phase                      | Status     | Details                  |"
      - "+----------------------------+------------+--------------------------+"
    _extra: "{{ _rpt_footer_rows | default([]) }}"
    _footer:
      - "+----------------------------+------------+--------------------------+"
