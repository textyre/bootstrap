---
# === gpu_drivers — GPU detection and driver installation ===
# SRP: main.yml — ТОЛЬКО оркестратор.
# Каждый import_tasks = одна бизнес-функция роли.

- name: gpu_drivers role
  tags: ['gpu', 'drivers']
  block:

    - name: Preflight checks
      ansible.builtin.import_tasks: preflight.yml

    - name: Detect GPU vendor
      ansible.builtin.import_tasks: detect.yml

    - name: Install GPU drivers
      ansible.builtin.import_tasks: install.yml

    - name: Configure kernel modules and environment
      ansible.builtin.import_tasks: configure.yml

    - name: Manage initramfs
      ansible.builtin.import_tasks: initramfs.yml

    - name: Report GPU configuration
      ansible.builtin.import_tasks: report.yml
