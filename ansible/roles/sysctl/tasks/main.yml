---
# === sysctl — kernel parameter tuning ===
# Каждый import_tasks = одна бизнес-функция роли.
# SRP: main.yml — только оркестратор.

- name: Install required packages
  ansible.builtin.import_tasks: packages.yml
  when: ansible_facts['os_family'] in _sysctl_supported_os

- name: Manage services that conflict with sysctl hardening
  ansible.builtin.import_tasks: services.yml
  when: ansible_facts['os_family'] in _sysctl_supported_os

- name: Deploy kernel parameter configuration
  ansible.builtin.import_tasks: deploy.yml
  when: ansible_facts['os_family'] in _sysctl_supported_os

- name: Verify applied parameters
  ansible.builtin.import_tasks: verify.yml
  when: ansible_facts['os_family'] in _sysctl_supported_os

- name: Report configuration summary
  ansible.builtin.import_tasks: report.yml
  when: ansible_facts['os_family'] in _sysctl_supported_os
