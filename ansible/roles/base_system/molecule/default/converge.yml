---
# Molecule converge playbook for base_system role
# Тестирует мультилокаль (en_US + ru_RU), LC_* overrides

- name: Converge
  hosts: all
  become: true
  gather_facts: true
  vars_files:
    - "{{ lookup('env', 'MOLECULE_PROJECT_DIRECTORY') }}/inventory/group_vars/all/vault.yml"

  pre_tasks:
    - name: Ensure we're running on Arch Linux
      ansible.builtin.assert:
        that:
          - ansible_facts['os_family'] is defined
          - ansible_facts['os_family'] == 'Archlinux'
        fail_msg: "This test requires Arch Linux"

  roles:
    - role: base_system
      vars:
        base_system_locales:
          - "en_US.UTF-8"
          - "ru_RU.UTF-8"
        base_system_lc_overrides:
          LC_TIME: "ru_RU.UTF-8"
