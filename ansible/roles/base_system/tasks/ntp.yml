---
# === NTP — синхронизация времени ===
# chrony как универсальный NTP-демон (все дистро, все init-системы)

- name: Install NTP daemon ({{ base_system_ntp_daemon }})
  ansible.builtin.package:
    name: "{{ _base_system_ntp_package[ansible_facts['os_family']] | default(base_system_ntp_daemon) }}"
    state: present
  tags: ['system', 'ntp']

- name: Disable systemd-timesyncd (replaced by {{ base_system_ntp_daemon }})
  ansible.builtin.service:
    name: systemd-timesyncd
    enabled: false
    state: stopped
  when: ansible_facts['service_mgr'] == 'systemd'
  failed_when: false
  tags: ['system', 'ntp']

- name: Enable NTP daemon
  ansible.builtin.service:
    name: "{{ _base_system_ntp_service[ansible_facts['service_mgr']] | default('chronyd') }}"
    enabled: true
    state: started
  tags: ['system', 'ntp']
