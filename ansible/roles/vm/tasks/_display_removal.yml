---
# =========================================================================
# _display_removal.yml
# =========================================================================
# Display removal report tables for services and packages.
#
# Expected variables:
#   vm_pkg_label      (string) - Hypervisor label
#   vm_rpt_svc_rows   (list)  - Service table rows (from _build_svc_report.yml)
#   vm_rpt_pkg_rows   (list)  - Package table rows (from _build_pkg_report.yml)
# =========================================================================

- name: "Removal report — Services ({{ vm_pkg_label }})"
  ansible.builtin.debug:
    msg: "{{ header + vm_rpt_svc_rows + [border] }}"
  vars:
    border: "+----------------------+------------+------------------------------+"
    header:
      - "{{ vm_pkg_label }} — Services"
      - "{{ border }}"
      - "| {{ '%-20s' | format('Service') }} | {{ '%-10s' | format('Status') }} | {{ '%-28s' | format('Details') }} |"
      - "{{ border }}"
  when: vm_rpt_svc_rows | length > 0
  tags: ['vm', 'vm:report']

- name: "Removal report — Packages ({{ vm_pkg_label }})"
  ansible.builtin.debug:
    msg: "{{ header + vm_rpt_pkg_rows + [border] }}"
  vars:
    border: "+----------------------+------------+------------------------------+"
    header:
      - "{{ vm_pkg_label }} — Packages"
      - "{{ border }}"
      - "| {{ '%-20s' | format('Package') }} | {{ '%-10s' | format('Status') }} | {{ '%-28s' | format('Details') }} |"
      - "{{ border }}"
  when: vm_rpt_pkg_rows | length > 0
  tags: ['vm', 'vm:report']
