---
# === ntp_audit — runtime NTP health audit ===

ntp_audit_enabled: true

# Audit schedule interval
ntp_audit_interval_systemd: "*:0/5"
ntp_audit_interval_cron: "*/5 * * * *"

# Log paths
ntp_audit_log_dir: "/var/log/ntp-audit"
ntp_audit_log_file: "/var/log/ntp-audit/audit.log"

# Log rotation
ntp_audit_logrotate_rotate: 7
ntp_audit_logrotate_size: "10M"

# Competing services to detect
ntp_audit_competitor_services:
  - systemd-timesyncd
  - ntpd
  - openntpd
  - vmtoolsd

# PHC devices to check for presence
ntp_audit_phc_devices:
  - /dev/ptp_hyperv
  - /dev/ptp0

# Kernel modules to check (empty = skip)
ntp_audit_kernel_modules:
  - ptp_kvm

# Grafana Alloy integration — separate enable flag
ntp_audit_alloy_enabled: true
ntp_audit_alloy_config_dir: "/etc/alloy/conf.d"

# Loki ruler rules — separate enable flag
ntp_audit_loki_enabled: true
ntp_audit_loki_rules_dir: "/etc/loki/rules/fake"

# chrony log dir (for Alloy config fragment)
ntp_audit_chrony_log_dir: "/var/log/chrony"

# Alert thresholds
ntp_audit_alert_offset_threshold: "0.1"
ntp_audit_alert_stratum_max: "4"
