---
# Handlers for hostctl role
# Uses hostctl sync (NOT replace) so profiles are created on first run and
# updated on subsequent runs without overwriting base /etc/hosts entries.

- name: Apply hostctl profiles
  ansible.builtin.command:
    cmd: "hostctl sync {{ item.key }} --from /etc/hostctl/{{ item.key }}.hosts"
  loop: "{{ hostctl_profiles | dict2items }}"
  listen: "apply hostctl profiles"
  changed_when: true
  when: hostctl_profiles | length > 0
