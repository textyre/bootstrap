---
# ============================================================
# power_management — полная спецификация переменных
# ============================================================

# ---- Global ----
power_management_enabled: true

# ---- Internal ----
power_management_supported_os:
  - Archlinux
  - Debian

power_management_laptop_chassis_types:
  - "8"   # Portable
  - "9"   # Laptop
  - "10"  # Notebook
  - "14"  # Sub Notebook
  - "30"  # Tablet
  - "31"  # Convertible
  - "32"  # Detachable

# ---- Internal facts (overridden by detect.yml) ----
# Explicit defaults ensure safe behaviour when power_management_enabled: false
power_management_is_laptop: false
power_management_init: "unknown"
power_management_cpu_is_intel: false
power_management_cpu_is_amd: false

# ---- Device detection ----
# auto = detect via DMI chassis_type
# laptop / desktop = force specific mode
power_management_device_type: auto

# ---- TLP (laptop only) ----
# CPU
power_management_tlp_cpu_governor_ac: performance
power_management_tlp_cpu_governor_bat: powersave
power_management_tlp_cpu_boost_ac: true
power_management_tlp_cpu_boost_bat: false
power_management_tlp_cpu_epp_ac: performance
power_management_tlp_cpu_epp_bat: power
power_management_tlp_cpu_min_freq_ac: ""
power_management_tlp_cpu_max_freq_bat: ""

# Disk
power_management_tlp_disk_devices: ""
power_management_tlp_disk_iosched: mq-deadline
power_management_tlp_disk_apm_ac: 254
power_management_tlp_disk_apm_bat: 128
power_management_tlp_sata_linkpwr_ac: max_performance
power_management_tlp_sata_linkpwr_bat: min_power

# USB
power_management_tlp_usb_autosuspend: true
power_management_tlp_usb_allowlist: []
power_management_tlp_usb_denylist: []

# PCIe
power_management_tlp_pcie_aspm_ac: default
power_management_tlp_pcie_aspm_bat: powersupersave

# WiFi
power_management_tlp_wifi_pwr_ac: "off"
power_management_tlp_wifi_pwr_bat: "on"

# Sound
power_management_tlp_sound_powersave_bat: true
power_management_tlp_sound_powersave_controller: true

# Runtime PM
power_management_tlp_runtime_pm_ac: "on"
power_management_tlp_runtime_pm_bat: auto

# Battery charge thresholds (ThinkPad/Dell — empty string = don't configure)
power_management_tlp_bat0_charge_start: ""
power_management_tlp_bat0_charge_stop: ""
power_management_tlp_bat1_charge_start: ""
power_management_tlp_bat1_charge_stop: ""

# ---- CPU governor (desktop) ----
power_management_cpu_governor: schedutil
# persist method: udev (init-agnostic, recommended) | service (systemd only) | oneshot (no reboot survival)
power_management_governor_persist: udev

# ---- systemd sleep ----
# NOTE: The sleep MODE (suspend / hibernate / hybrid-sleep) is chosen at
# runtime via logind.conf actions (HandleLidSwitch, IdleAction) or manually
# with 'systemctl suspend|hibernate|hybrid-sleep'. The settings below control
# HOW each mode is implemented by the kernel — see systemd.sleep.conf(5).
power_management_hibernate_mode: platform
power_management_suspend_state: ""
power_management_hibernate_delay_sec: ""

# ---- logind (systemd only) ----
power_management_lid_switch_action: suspend
power_management_lid_switch_ac_action: suspend
power_management_lid_switch_docked_action: ignore
power_management_power_key_action: poweroff
power_management_suspend_key_action: suspend
power_management_hibernate_key_action: ignore
power_management_idle_action: ignore
power_management_idle_action_sec: "30min"

# ---- Audit & Monitoring ----
power_management_audit_enabled: true
power_management_audit_schedule: "daily"
power_management_audit_battery: true
power_management_audit_battery_wear_threshold: 20

power_management_drift_detection: true
power_management_drift_state_dir: /var/lib/ansible-power-management

# Cron schedule for non-systemd systems (ignored when systemd is available)
power_management_audit_cron_hour: "0"
power_management_audit_cron_minute: "0"

# ---- Assertions ----
power_management_assert_strict: true
