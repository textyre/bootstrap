{{- $t := index .themes .theme_name -}}
; ============================================================
; Polybar Config — 3-Bar Floating Islands Design
; Generated by chezmoi — DO NOT EDIT DIRECTLY
; ============================================================

; ============================================================
; COLORS
; ============================================================
[colors]
background     = #00000000
foreground     = {{ $t.fg }}
foreground-dim = {{ $t.fg_dim }}
accent         = {{ $t.accent }}
accent2        = {{ $t.accent2 }}
urgent         = {{ $t.urgent }}
success        = {{ $t.success }}
warning        = {{ $t.warning }}
info           = {{ $t.info }}
island         = #dd{{ trimPrefix "#" $t.bg }}
island-border  = #66{{ trimPrefix "#" $t.border_active }}

; ============================================================
; BAR: WORKSPACES (LEFT ISLAND)
; ============================================================
[bar/workspaces]
monitor = ${env:MONITOR:}
width = ${env:WS_BAR_WIDTH:{{ .layout.bar_width_workspaces }}}
offset-x = {{ .layout.gaps_outer }}
offset-y = {{ .layout.bar_offset_y }}
height = {{ .layout.bar_height }}

background = ${colors.island}
foreground = ${colors.foreground}
radius = {{ .layout.bar_radius }}
border-size = {{ .layout.bar_border }}
border-color = ${colors.island-border}

override-redirect = true

modules-center = workspaces

enable-ipc = true
cursor-click = pointer

font-0 = {{ .font.mono }}:size={{ .font.bar_size }}:weight=bold;{{ .layout.font_offset }}
font-1 = {{ .font.icon }}:size={{ .font.icon_size }};{{ .layout.font_offset }}
font-2 = {{ .font.mono }}:size={{ .font.bar_size }};{{ .layout.font_offset }}

padding-left = {{ .layout.bar_padding_ws }}px
padding-right = {{ .layout.bar_padding_ws }}px

; ============================================================
; BAR: WORKSPACE ADD (LEFT ISLAND - ADD BUTTON)
; ============================================================
[bar/workspace-add]
monitor = ${env:MONITOR:}
width = 40
; Position = gaps_outer + bar_width_workspaces + gap between islands
offset-x = ${env:WS_ADD_OFFSET:{{ add .layout.gaps_outer .layout.bar_width_workspaces 4 }}}
offset-y = {{ .layout.bar_offset_y }}
height = {{ .layout.bar_height }}

background = ${colors.island}
foreground = ${colors.foreground}
radius = {{ .layout.bar_radius }}
border-size = {{ .layout.bar_border }}
border-color = ${colors.island-border}

override-redirect = true

modules-center = workspace-add-btn

enable-ipc = true
cursor-click = pointer

font-0 = {{ .font.mono }}:size={{ .font.bar_size }}:weight=bold;{{ .layout.font_offset }}
font-1 = {{ .font.icon }}:size={{ .font.icon_size }};{{ .layout.font_offset }}
font-2 = {{ .font.mono }}:size={{ .font.bar_size }};{{ .layout.font_offset }}

padding-left = 0
padding-right = 0

; ============================================================
; BAR: CLOCK (CENTER ISLAND)
; ============================================================
[bar/clock]
monitor = ${env:MONITOR:}
width = {{ .layout.bar_width_clock }}
offset-x = 50%:-{{ div .layout.bar_width_clock 2 }}
offset-y = {{ .layout.bar_offset_y }}
height = {{ .layout.bar_height }}

background = ${colors.island}
foreground = ${colors.foreground}
radius = {{ .layout.bar_radius }}
border-size = {{ .layout.bar_border }}
border-color = ${colors.island-border}

override-redirect = true

modules-center = date

enable-ipc = true
cursor-click = pointer

font-0 = {{ .font.mono }}:size={{ .font.bar_size }}:weight=bold;{{ .layout.font_offset }}
font-1 = {{ .font.icon }}:size={{ .font.icon_size }};{{ .layout.font_offset }}
font-2 = {{ .font.mono }}:size={{ .font.bar_size }};{{ .layout.font_offset }}

padding-left = {{ .layout.bar_padding }}px
padding-right = {{ .layout.bar_padding }}px

; ============================================================
; BAR: SYSTEM (RIGHT ISLAND)
; ============================================================
[bar/system]
monitor = ${env:MONITOR:}
width = {{ .layout.bar_width_system }}
offset-x = 100%:-{{ add .layout.bar_width_system .layout.gaps_outer }}
offset-y = {{ .layout.bar_offset_y }}
height = {{ .layout.bar_height }}

background = ${colors.island}
foreground = ${colors.foreground}
radius = {{ .layout.bar_radius }}
border-size = {{ .layout.bar_border }}
border-color = ${colors.island-border}

override-redirect = true

modules-left = network sep volume sep cpu sep memory
modules-right = sep controlcenter sep powermenu sep tray

enable-ipc = true
cursor-click = pointer
cursor-scroll = ns-resize

font-0 = {{ .font.mono }}:size={{ .font.bar_size }}:weight=bold;{{ .layout.font_offset }}
font-1 = {{ .font.icon }}:size={{ .font.icon_size }};{{ .layout.font_offset }}
font-2 = {{ .font.mono }}:size={{ .font.bar_size }};{{ .layout.font_offset }}

padding-left = {{ .layout.bar_padding }}px
padding-right = {{ .layout.bar_padding }}px

; ============================================================
; MODULE: WORKSPACES
; ============================================================
[module/workspaces]
type = custom/script
exec = ~/.config/polybar/scripts/workspaces.sh
tail = true

; ============================================================
; MODULE: WORKSPACE ADD BUTTON
; ============================================================
[module/workspace-add-btn]
type = custom/text
format = "%{T2}+%{T-}"
format-foreground = ${colors.accent}
click-left = ~/.config/polybar/scripts/add-workspace.sh

; ============================================================
; MODULE: SEPARATOR
; ============================================================
[module/sep]
type = custom/text
format = "%{O{{ .layout.sep_gap }}}"

; ============================================================
; MODULE: DATE/TIME
; ============================================================
[module/date]
type = internal/date
interval = 1
date = "%a %b %d"
time = "%H:%M"
format = <label>
format-foreground = ${colors.foreground}
format-padding = 2
label = "%{T2}%{T-}  %date%    %time%"
click-left = gsimplecal &

; ============================================================
; MODULE: NETWORK
; ============================================================
[module/network]
type = internal/network
interface-type = {{ .layout.network_interface_type }}
interval = 3
format-connected = <label-connected>
format-connected-padding = 1
label-connected = "%{T2}%{T-}  %local_ip%"
label-connected-foreground = ${colors.success}
format-disconnected = <label-disconnected>
format-disconnected-padding = 1
label-disconnected = "%{T2}%{T-}  disconnected"
label-disconnected-foreground = ${colors.urgent}
click-left = alacritty -e nmtui &

; ============================================================
; MODULE: VOLUME
; ============================================================
[module/volume]
type = internal/pulseaudio
use-ui-max = true
format-volume = <label-volume>
format-volume-padding = 1
label-volume = "%{T2}%{T-}  %percentage%%"
label-volume-foreground = ${colors.foreground}
format-muted = <label-muted>
format-muted-padding = 1
label-muted = "%{T2}%{T-}  muted"
label-muted-foreground = ${colors.foreground-dim}
click-left = pavucontrol &
scroll-up = pamixer -i 5
scroll-down = pamixer -d 5

; ============================================================
; MODULE: CPU
; ============================================================
[module/cpu]
type = internal/cpu
interval = 2
format = <label>
format-padding = 1
label = "%{T2}%{T-}  %percentage%%"
label-foreground = ${colors.info}

; ============================================================
; MODULE: MEMORY
; ============================================================
[module/memory]
type = internal/memory
interval = 3
format = <label>
format-padding = 1
label = "%{T2}%{T-}  %percentage_used%%"
label-foreground = ${colors.warning}

; ============================================================
; MODULE: CONTROL CENTER
; ============================================================
[module/controlcenter]
type = custom/text
format = "%{T2}%{T-}"
format-foreground = ${colors.accent}
format-padding = 1
click-left = ~/.config/rofi/scripts/controlcenter.sh &

; ============================================================
; MODULE: POWER MENU
; ============================================================
[module/powermenu]
type = custom/text
format = "%{T2}%{T-}"
format-foreground = ${colors.urgent}
format-padding = 1
click-left = ~/.config/rofi/scripts/powermenu.sh &

; ============================================================
; MODULE: TRAY
; ============================================================
[module/tray]
type = internal/tray
tray-spacing = 4
tray-size = 18

; ============================================================
; SETTINGS
; ============================================================
[settings]
screenchange-reload = true
pseudo-transparency = true
