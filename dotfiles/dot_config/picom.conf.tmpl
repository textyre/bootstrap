{{- $t := index .themes .theme_name -}}
# Picom compositor — Cyberpunk Rice
# Generated by chezmoi — DO NOT EDIT DIRECTLY

# === BACKEND ===
backend = "glx";
# vsync = true;
# use-damage = true;

# === ROUNDED CORNERS ===
corner-radius = {{ .layout.corner_radius }};
rounded-corners-exclude = [
  "window_type = 'dock'",
  "window_type = 'desktop'",
  "window_type = 'popup_menu'",
  "window_type = 'tooltip'",
  "class_g = 'Polybar'",
  "fullscreen"
];

detect-client-opacity = true;
detect-rounded-corners = true;

# === SHADOWS ===
shadow = true;
shadow-radius = {{ .picom.shadow_radius }};
shadow-offset-x = {{ .picom.shadow_offset_x }};
shadow-offset-y = {{ .picom.shadow_offset_y }};
shadow-opacity = {{ .picom.shadow_opacity }};

shadow-exclude = [
  "class_g = 'Polybar'",
  "_GTK_FRAME_EXTENTS@:c"
];

# === OPACITY ===
active-opacity = {{ .picom.active_opacity }};
inactive-opacity = {{ .picom.inactive_opacity }};
frame-opacity = {{ .picom.frame_opacity }};
inactive-opacity-override = false;

opacity-rule = [
  "{{ .picom.opacity_firefox }}:class_g = 'firefox'",
  "{{ .picom.opacity_firefox }}:class_g = 'Brave-browser'",
  "{{ .picom.opacity_firefox }}:fullscreen",
  "{{ .picom.opacity_terminal_focused }}:class_g = 'Alacritty' && focused",
  "{{ .picom.opacity_terminal_unfocused }}:class_g = 'Alacritty' && !focused",
  "{{ .picom.opacity_rofi }}:class_g = 'Rofi'"
];

# === BLUR ===
blur-background = true;
blur-background-frame = true;

blur: {
  method = "{{ .picom.blur_method }}";
  strength = {{ .picom.blur_strength }};
};

blur-background-exclude = [
  "window_type = 'dock'",
  "window_type = 'desktop'",
  "class_g = 'Polybar'",
  "_GTK_FRAME_EXTENTS@:c"
];

# === ANIMATIONS (picom-ftlabs) ===
animations = true;
animation-stiffness-in-tag = {{ .picom.animation_stiffness }};
animation-stiffness-tag-change = {{ .picom.animation_stiffness_tag }};
animation-dampening = {{ .picom.animation_dampening }};
animation-window-mass = {{ .picom.animation_mass }};
animation-clamping = true;
animation-for-open-window = "zoom";
animation-for-unmap-window = "slide-down";
animation-for-transient-window = "slide-down";

# === FADING ===
fading = true;
fade-in-step = {{ .picom.fade_step }};
fade-out-step = {{ .picom.fade_step }};
fade-delta = {{ .picom.fade_delta }};

fade-exclude = [];

# === WINDOW TYPE SETTINGS ===
wintypes: {
  tooltip = { fade = true; shadow = false; opacity = 0.9; };
  dock = { shadow = false; clip-shadow-above = true; };
  dnd = { shadow = false; };
  popup_menu = { opacity = 0.95; shadow = true; };
  dropdown_menu = { opacity = 0.95; shadow = true; };
};
