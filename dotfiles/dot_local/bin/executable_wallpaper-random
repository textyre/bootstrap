#!/usr/bin/env bash
# Set a random wallpaper from the wallpapers directory
# Usage: wallpaper-random

set -euo pipefail

WALLPAPER_DIR="${XDG_DATA_HOME:-$HOME/.local/share}/wallpapers"

if [[ ! -d "$WALLPAPER_DIR" ]]; then
    echo "Wallpaper directory not found: $WALLPAPER_DIR" >&2
    exit 1
fi

# Find image files
WALLPAPER=$(find "$WALLPAPER_DIR" -maxdepth 1 -type f \
    \( -iname '*.png' -o -iname '*.jpg' -o -iname '*.jpeg' -o -iname '*.webp' -o -iname '*.bmp' \) \
    | shuf -n 1)

if [[ -z "$WALLPAPER" ]]; then
    echo "No wallpapers found in $WALLPAPER_DIR" >&2
    exit 1
fi

wallpaper-set "$WALLPAPER"
